<apex:page standardController="Patient_Pathway__c" renderAs="pdf" applyHtmlTag="false" showHeader="false" standardStylesheets="false">
    
    <head>
        <meta charset="utf-8"/>
        <style>
            /* --- Page Setup --- */
            @page {
                size: Letter landscape; /* Changed from A4 to Letter */
                margin: 0;
            }

            /* --- Base Styles --- */
            html, body {
                font-family: 'Arial', sans-serif;
                margin: 0;
                padding: 0;
                width: 100%;
                height: 100%;
            }

            /* Full-page background image */
            body {
                background-image: url("{!$Resource.CertificateBG}");
                background-size: cover; /* Fill entire page proportionally */
                background-position: center;
                background-repeat: no-repeat;
            }
           

            /* Container table for layout */
            .container-table {
                width: 100%;
                height: 100%;
                border-collapse: collapse;
                text-align: center;
            }

            /* Sections */
            .header-section {
                height: 15%; /* Top space */
                vertical-align: top;
                text-align: left;
                padding-left: 40px;
            }
            .main-section {
                height: 70%; /* Middle content */
                vertical-align: middle;
                text-align: center;
            }
            .footer-section {
                height: 15%; /* Bottom space */
                vertical-align: bottom;
                text-align: center;
            }

            /* Logo */
            .logo {
                width: 80px;
                height: 80px;
                
            }

            /* Titles */
            .title {
                font-family: 'Times New Roman', serif;
                font-size: 3rem;
                color: #1976d2;
                margin: 0;
                text-transform: uppercase;
                letter-spacing: 7px;
                font-weight: 900;
            }

            .presenting-text {
                font-size: 1.2rem;
                color: #555;
                margin: 10px 0;
                font-style: italic;
            }

            .recipient-name {
                font-family: 'Georgia', serif;
                font-size: 3rem;
                color: #007bff;
                margin: 15px 0 25px 0;
                border-bottom: 3px solid #007bff;
                padding-bottom: 8px;
                display: inline-block;
                font-weight: bold;
            }

            .program-name {
                font-size: 1.5rem;
                font-weight: 700;
                color: #1976d2;
                margin-top: 15px;
                padding: 10px 20px;
                background-color: #e3f2fd;
                text-transform: capitalize;
                display: inline-block;
            }

            /* Signature Area */
            .signature-table {
                width: 90%;
                margin: 0 auto;
                border-collapse: collapse;
            }
            .detail-block {
                text-align: center;
                width: 50%;
                padding: 0 1rem;
            }
            .signature-line {
                border-top: 2px solid #1565c0;
                margin-top: 20px;
                margin-bottom: 5px;
            }
            .detail-label {
                font-size: 0.95rem;
                color: #1976d2;
                text-transform: uppercase;
                letter-spacing: 2.5px;
                font-weight: bold;
            }
            .detail-value {
                font-size: 1.2rem;
                color: #333;
                margin-bottom: 5px;
            }
        </style>
    </head>
    
    <body>
        <table class="container-table">
            <tr class="header-section">
                <td>
                    <apex:image url="{!$Resource.PulsePointLogo}" styleClass="logo"/>
                </td>
            </tr>

            <tr class="main-section">
                <td>
                    <div class="title">Certificate</div>
                    <div class="title">of Completion</div>

                    <p class="presenting-text">This document certifies that</p>

                    <p class="recipient-name">
                        <apex:outputText value="{!Patient_Pathway__c.Patient__r.Name}" escape="true"/>
                    </p>

                    <p class="presenting-text">has successfully completed all requirements for the</p>

                    <p class="program-name">
                        "<apex:outputText value="{!Patient_Pathway__c.Wellness_Program_Details__r.Name}" escape="true"/>" Program
                    </p>
                </td>
            </tr>

            <tr class="footer-section">
                <td>
                    <table class="signature-table">
                        <tr>
                            <td class="detail-block">
                                <div class="signature-line"></div>
                                <div class="detail-label">Date of Completion</div>
                                <span class="detail-value">
                                    <apex:outputText value="{0,date,MMMM dd, yyyy}">
                                        <apex:param value="{!Patient_Pathway__c.Date_Administered__c}" />
                                    </apex:outputText>
                                </span>
                            </td>

                            <td class="detail-block">
                                <div class="signature-line"></div>
                                <div class="detail-label">Authorized Signatory</div>
                                <span class="detail-value">Director, Health Services</span>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
    </body>
</apex:page>